{"version":3,"sources":["scripts/app-95ab2436df.js"],"names":["angular","module","MainController","ReviewService","activate","query","then","reviews","vm","averageRating","length","total","reduce","review","rating","Math","round","reviewCountByUserType","userType","filter","user","type","reviewCountByRating","helpful","id","helpful_count","notHelpful","not_helpful_count","this","filters","label","filterProp","undefined","orders","title","prop","order","controller","$inject","httpConfig","$httpProvider","AuthTokenInterceptor","request","config","headers","interceptors","push","constant","API_URL","$http","get","response","data","reviewId","vote","post","service","run","$templateCache","put"],"mappings":"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","file":"scripts/app-95ab2436df.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular.module('app', ['blockUI']);\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('app')\n        .controller('MainController', MainController);\n\n    /** @ngInject */\n    function MainController(ReviewService) {\n        var vm = this;\n\n        vm.reviews = [];\n        vm.filters = [\n            {label: 'Everyone', type: 'any'},\n            {label: 'Readers', type: 'reader', filterProp: {user: {type: 'reader'}}},\n            {label: 'Critics', type: 'critic', filterProp: {user: {type: 'critic'}}},\n            {label: 'Editors', type: 'editor', filterProp: {user: {type: 'editor'}}},\n            {label: 'Librarians', type: 'librarian', filterProp: {user: {type: 'librarian'}}},\n            {label: 'Bloggers', type: 'blogger', filterProp: {user: {type: 'blogger'}}}\n        ];\n        vm.filterProp = undefined;\n        vm.orders = [\n            {label: 'Most Helpful', title: 'Most Helpful', prop: ['-helpful_count', '+not_helpful_count']},\n            {label: 'Highest Rating', title: 'Highest Rated', prop: '-rating'},\n            {label: 'Newest First', title: 'Newest', prop: '-date'}\n        ];\n        vm.order = vm.orders[0];\n\n        vm.averageRating = averageRating;\n        vm.reviewCountByUserType = reviewCountByUserType;\n        vm.reviewCountByRating = reviewCountByRating;\n        vm.helpful = helpful;\n        vm.notHelpful = notHelpful;\n\n        activate();\n\n        function activate() {\n            ReviewService.query().then(function (reviews) {\n                vm.reviews = reviews;\n            });\n        }\n\n        function averageRating() {\n            if (!vm.reviews.length)\n                return 0;\n\n            var total = vm.reviews.reduce(function sum(total, review) {\n                return total + review.rating;\n            }, 0);\n\n            return Math.round(total / vm.reviews.length);\n        }\n\n        function reviewCountByUserType(userType) {\n            if (userType === 'any')\n                return vm.reviews.length;\n\n            return vm.reviews.filter(function (review) {\n                return review.user.type === userType;\n            }).length;\n        }\n\n        function reviewCountByRating(rating) {\n            return vm.reviews.filter(function (review) {\n                return review.rating === rating;\n            }).length;\n        }\n\n        function helpful(review) {\n            ReviewService.helpful(review.id).then(function () {\n                review.helpful_count++;\n            });\n        }\n\n        function notHelpful(review) {\n            ReviewService.notHelpful(review.id).then(function () {\n                review.not_helpful_count++;\n            });\n        }\n\n    }\n})();\n\n(function () {\n\n    angular.module('app')\n        .config(httpConfig);\n\n    /** @ngInject */\n    function httpConfig($httpProvider) {\n        $httpProvider.interceptors.push(AuthTokenInterceptor);\n\n        /** @ngInject */\n        function AuthTokenInterceptor() {\n            return {\n                request: request\n            };\n\n            function request(config) {\n                config.headers['X-client_id'] = '110aff0820835c55266969626419d51d5d9e6892cb827acb75fc71ed9ca72344';\n                return config;\n            }\n        }\n    }\n\n})();\n\n(function () {\n\n    angular.module('app')\n        .constant('API_URL', 'https://vngrs-challenge.herokuapp.com/api/');\n\n})();\n\n(function () {\n\n    angular.module('app')\n        .service('ReviewService', ReviewService);\n\n    /** @ngInject */\n    function ReviewService(API_URL, $http) {\n\n        this.query = query;\n        this.helpful = helpful;\n        this.notHelpful = notHelpful;\n\n        function query() {\n            return $http.get(API_URL + 'reviews').then(function (response) {\n                return response.data.data;\n            });\n        }\n\n        function helpful(reviewId) {\n            return vote(reviewId, true);\n        }\n\n        function notHelpful(reviewId) {\n            return vote(reviewId, false);\n        }\n\n        function vote(reviewId, helpful) {\n            return $http.post(API_URL + 'reviews/' + reviewId + '/vote', {\n                type: helpful ? 'helpful' : 'not_helpful'\n            }).then(function (response) {\n                return response.data;\n            });\n        }\n    }\n\n})();\n\nangular.module(\"app\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/main/main.html\",\"<div class=\\\"container\\\" ng-controller=\\\"MainController as vm\\\"> <div class=\\\"page-title\\\"> <div class=\\\"text\\\"> <div class=\\\"book\\\">Book</div> <div class=\\\"reviews\\\">Reviews</div> </div> <div class=\\\"review-stats\\\"> <div class=\\\"average\\\"> <span ng-repeat=\\\"i in [1, 2, 3, 4, 5]\\\" class=\\\"star glyphicon glyphicon-star\\\" ng-class=\\\"{active: vm.averageRating() >= i}\\\"> </span> </div> <div class=\\\"total\\\"> {{vm.reviews.length}} Total Reviews </div> </div> </div> <div class=\\\"ribbons-title\\\"> See reviews from: </div> <div class=\\\"row\\\"> <div class=\\\"main-content col-sm-9\\\"> <div class=\\\"reviews-header\\\"> <div class=\\\"ribbons\\\"> <span ng-repeat=\\\"f in vm.filters\\\" ng-click=\\\"vm.filterProp = f.filterProp\\\" class=\\\"ribbon {{f.type}}\\\" ng-class=\\\"{active: vm.filterProp === f.filterProp}\\\"> <span>{{f.label}}</span> <span>({{vm.reviewCountByUserType(f.type)}})</span> </span> </div> <div class=\\\"sorting\\\"> <div class=\\\"selected\\\"> <div class=\\\"title\\\">{{vm.order.title}}</div> <div class=\\\"reviews\\\">Reviews</div> </div> <label class=\\\"select pull-right\\\"> <span class=\\\"sort-by\\\">Sort by:</span> <select ng-model=\\\"vm.order\\\" class=\\\"btn\\\" ng-options=\\\"item as item.label for item in vm.orders\\\"> </select> </label> </div> </div> <div class=\\\"reviews-list\\\"> <div class=\\\"review-item\\\" ng-repeat=\\\"review in vm.reviews | filter:vm.filterProp | orderBy:vm.order.prop | limitTo:3\\\"> <div class=\\\"review-header\\\"> <div class=\\\"review-meta\\\"> <div class=\\\"date\\\">{{review.date | date:\\'MMMM d, y\\'}}</div> <div class=\\\"user\\\">{{review.user.firstname}} {{review.user.lastname}}</div> <div class=\\\"book-type\\\">{{review.book_type}}</div> </div> <div class=\\\"review-rating\\\"> <span ng-repeat=\\\"i in [1, 2, 3, 4, 5]\\\" class=\\\"star glyphicon glyphicon-star\\\" ng-class=\\\"{active: review.rating >= i}\\\"> </span> </div> <div class=\\\"review-title\\\">{{review.title}}</div> </div> <div class=\\\"review-content\\\"> {{review.content | limitTo:1000}} </div> <div class=\\\"review-footer\\\"> <a href=\\\"\\\" class=\\\"read-more\\\" ng-if=\\\"review.content.length > 1000\\\"> Read more... </a> <div class=\\\"helpful-stats\\\"> {{review.helpful_count}} out of {{review.helpful_count + review.not_helpful_count}} found this review helpful. </div> <div class=\\\"actions\\\"> <span class=\\\"is-this-helpful\\\">Was this review helpful to you?</span> <a class=\\\"vote helpful\\\" href=\\\"\\\" ng-click=\\\"vm.helpful(review)\\\"> <i class=\\\"glyphicon glyphicon-thumbs-up\\\"></i> Helpful </a> <a class=\\\"vote not-helpful\\\" href=\\\"\\\" ng-click=\\\"vm.notHelpful(review)\\\"> <i class=\\\"glyphicon glyphicon-thumbs-down\\\"></i> Not Helpful </a> <a class=\\\"flag\\\" href=\\\"\\\"> <i class=\\\"glyphicon glyphicon-flag\\\"></i> Flag This Content For Review </a> </div> </div> </div> </div> <div class=\\\"reviews-footer\\\"> <button class=\\\"btn btn-default see-all-reviews\\\"> See all {{vm.reviews.length}} reviews <i class=\\\"glyphicon glyphicon-chevron-right\\\"></i> </button> <button class=\\\"add-a-review btn btn-primary pull-right\\\"> <i class=\\\"glyphicon glyphicon-comment\\\"></i> Add a review </button> </div> </div> <div ng-include=\\\"\\'app/sidebar/sidebar.html\\'\\\" class=\\\"sidebar col-sm-3\\\"> </div> </div> </div> \");\n$templateCache.put(\"app/navbar/navbar.html\",\"<nav class=\\\"navbar navbar-inverse navbar-fixed-top\\\"> <div class=\\\"container\\\"> <div class=\\\"navbar-header\\\"> <img src=\\\"/assets/images/logo.png\\\"> </div> <div class=\\\"navbar-collapse collapse\\\"> <ul class=\\\"nav navbar-nav navbar-right\\\"> <li> <form class=\\\"navbar-form\\\"> <div class=\\\"input-group search\\\"> <input class=\\\"form-control\\\" name=\\\"search-input\\\" placeholder=\\\"Search by Title, Author, Genre, Keyword...\\\"> <div class=\\\"input-group-btn\\\"> <button class=\\\"btn btn-default\\\"> <i class=\\\"glyphicon glyphicon-search\\\"></i> </button> </div> </div> </form> </li> <li><a href=\\\"\\\">Recommendations</a></li> <li><a href=\\\"\\\">Subjects <span class=\\\"caret\\\"></span></a></li> <li class=\\\"sign-in\\\"><a href=\\\"\\\">Sign in | Register</a></li> <li class=\\\"shopping-cart\\\"> <a href=\\\"\\\"> <i class=\\\"glyphicon glyphicon-shopping-cart\\\"></i> 0 </a> </li> </ul> </div> </div> </nav> \");\n$templateCache.put(\"app/sidebar/sidebar.html\",\"<div class=\\\"review-stats\\\"> <div class=\\\"average-rating\\\"> <div class=\\\"in-stars\\\"> <span ng-repeat=\\\"i in [1, 2, 3, 4, 5]\\\" class=\\\"star glyphicon glyphicon-star\\\" ng-class=\\\"{active: vm.averageRating() >= i}\\\"> </span> </div> <div class=\\\"in-words\\\"> Average Rating: {{vm.averageRating()}} out of 5 stars </div> </div> <div class=\\\"histogram\\\"> <div class=\\\"item\\\" ng-repeat=\\\"i in [5, 4, 3, 2, 1]\\\"> <div class=\\\"star-count\\\">{{i}} STAR</div> <div class=\\\"bar\\\"> <div class=\\\"filled\\\" ng-style=\\\"{\\'width\\': vm.reviewCountByRating(i)*100/vm.reviews.length + \\'%\\'}\\\"> </div> </div> <div class=\\\"rating-count\\\"> ({{vm.reviewCountByRating(i)}}) </div> </div> </div> <div class=\\\"footer\\\"> <a class=\\\"view-all-reviews\\\"> View all {{vm.reviews.length}} reviews </a> <button class=\\\"add-a-review btn btn-primary\\\"> <i class=\\\"glyphicon glyphicon-comment\\\"></i> Add a review </button> </div> </div> <div class=\\\"cart-wrapper\\\"> <div class=\\\"cart\\\"> <div class=\\\"book-type\\\">Paperback</div> <div class=\\\"price\\\">$2.00</div> <button class=\\\"btn btn-block btn-warning add-to-cart\\\"> Add to cart </button> <button class=\\\"btn btn-block btn-default buy-elsewhere\\\"> Buy elsewhere <i class=\\\"glyphicon glyphicon-chevron-down\\\"></i> </button> <div class=\\\"or\\\">-OR-</div> <button class=\\\"btn btn-block btn-danger buy-ebook-now\\\"> Buy ebook now </button> </div> </div> \");}]);"],"sourceRoot":"/source/"}